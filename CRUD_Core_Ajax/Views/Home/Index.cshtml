@{
    ViewData["Title"] = "Home Page";
}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
</div>

<div class="jumbotron">
    <div class="form-group">
        <label for="name">Book Name</label>
        <input type="text" class="form-control" id="name" placeholder="Enter Book Name">
    </div>
    <div class="form-group">
        <label for="isbn">ISBN</label>
        <input type="text" class="form-control" id="isbn" placeholder="ISBN Number">
    </div>
    <div class="form-group">
        <label for="author">Author Name</label>
        <input type="text" class="form-control" id="author" placeholder="Enter Author Name">
    </div>
    <div class="btn-group-sm">

        <button id="submit" type="submit" class="btn btn-primary">Add To Table</button>
        <button id="update" type="submit" class="btn btn-primary" style="display: none">Update Data</button>
        <button id="clear" type="button" class="btn btn-default" style="display: none">Cancel</button>
        <button id="addData" class="btn btn-info btn-sm">Add Data</button>
        <button id="addToDb" type="submit" class="btn btn-info">Add Multiple Data</button>
    </div>
</div>
<table id="tempTable" class="table table-striped table-bordered table-sm text-center">
    <thead class="table-dark">
        <tr>
            <td>Name</td>
            <td>ISBN</td>
            <td>Author</td>
            <td>Actions</td>
        </tr>
    </thead>
    <tbody></tbody>
</table>
<hr />
<table id="booksTable" class="table table-striped table-bordered table-sm text-center">
    <thead class="table-dark">
        <tr>
            <td>Name</td>
            <td>ISBN</td>
            <td>Author</td>
            <td>Actions</td>
        </tr>
    </thead>
    <tbody></tbody>
</table>

@section Scripts{
    <script type="text/javascript">

        $(document).ready(() => {
            GetData();
            $("#addData").click(() => {
                debugger;
                var book = new Object();
                book.Name = $("#name").val();
                book.ISBN = $("#isbn").val();
                book.Author = $("#author").val();
                AddData(book);
            });
        });

        function GetData() {
            var html = "";
            $.ajax({
                url: "/Home/GetData/",
                type: "GET",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
                    if (result.length !== 0) {
                        $.each(result,
                            function (key, item) {
                                html += " <tr id=" + item.id + "><td>" +
                                    item.name +
                                    "</td><td>" +
                                    item.isbn +
                                    "</td><td>" +
                                    item.author +
                                    "</td><td>" +
                                    "<a href='#' onclick='DeleteData(" + item.id + ")'>Delete</a> | " +
                                    "<a href='#' onclick='EditData(this)'>Edit</a>" +
                                    "</td></tr>";
                            });
                        $("#booksTable > tbody").html(html);
                    } else {
                        html += "<tr><td><td><td>No Data Found</td></td></td></tr>";
                        $("#booksTable > tbody").html(html);
                    }

                },
                error: function (errormessage) {
                    alert("Something Went Wrong on Data Load");
                    console.log(errormessage.responseText);
                }
            });
        }

        function DeleteData(bookId) {

            var sure = confirm("Do You Want To Delete This Record?");

            if (sure) {
                $.ajax({
                    url: "/Home/DeleteData/?bookId=" + bookId,
                    type: "GET",
                    cache: false,
                    success: function (result) {
                        GetData();
                    },
                    error: function (errormessage) {
                        alert(errormessage.responseText);
                    }
                });
            }

        }

        function AddData(book) {
            $.ajax({
                url: "/Home/AddData/",
                type: "POST",
                data: JSON.stringify(book),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    debugger;
                    if (response != null) {
                        GetData();
                        $("input[type=text]").val("");

                    } else {
                        alert("Something went wrong");
                    }
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
        }

    </script>
}